##run adhoc with agemtless with winrm and ssh




gem install bolt
apt-get install puppet-bolt

#linux
##to ignore failure use amdinistrator accounts\group

bolt command run 'ipconfig' -n ip,ip2 -u -p pass
bolt command run 'ipconfig' -n ip,ip2 -u -p ## prompt for password
#windows
bolt command run 'ipconfig' --transport winrm -n ip  -u administrator --no-ssl -p
bolt command run 'ipconfig' -t winrm://1ip:5985 -u user -p pass  --no-ssl
bolt command run 'sc stop winrm' -t winrm://1ip:5985 -u user -p pass  --no-ssl
bolt command run 'net start winrm' -t winrm://1ip:5985 -u user -p   --no-ssl# promp for password



##sc /? ##more sc cmds

sc query ## list all services

sc getdisplayname winrm##
sc query winrm


##winrm configuartion

winrm qucikconfig
winrm winrm/config/client @{TrustedHosts="127.0.0.1"}

winrm configsddl default@ add user for windows remote management group

net localgroup " ##list localgroups
net localgroup "remote mangemnt users" /add username



#run script

bolt  script run /tmp/script ipconfig' -n ip,ip2 -u -p pass

#task

bolt task run
puppet task show task name
