apt-get install python-winrm
apt-get install python3-winrm

on wwinows


winrm quickconfig
winrm set winrm/config/client @{Trustedhosts="ip1","ip2"}
winrm set winrm/config/service/auth @{Basic="True"}


working only when builtin user administrator user and pass is used


import winrm
s=winrm.Session("http://ip:5985",auth=("username","pass"),transport="ntlm")
>>> r = s.run_cmd('ipconfig')
r = s.run_ps('ipconfig')## run powershell
>>> r = s.run_cmd('sc query wuauserv')
>>> print r.std_out



##ansible host file 

[win]
192.168.6.102


[win:vars]
ansible_user=hostname\administrator
ansible_password=password
ansible_connection=winrm
ansible_winrm_scheme=http#
ansible_winrm_port=5985#comment both if https is used
ansible_winrm_server_cert_validation=ignore

ansible_user=username
ansible_password=password
ansible_connection=winrm
#ansible_host=ip
ansible_winrm_transport=ntlm|basic|kerberso
ansible_winrm_scheme=http
ansible_winrm_port=5985
ansible_winrm_server_cert_validation=ignore
